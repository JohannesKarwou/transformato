Transformato
==============================
[//]: # (Badges)
[![codecov](https://codecov.io/gh/wiederm/transformato/branch/master/graph/badge.svg)](https://codecov.io/gh/wiederm/transformato/branch/master)

Transformato is a package that helps to set up relative alchemica free energy calculations of small molecules with a common core scaffold, either for solvation free energy or binding free energy estimates. The package is designed to be used with output generated by CHARMM-GUI (www.charmm-gui.org).

### Theory

Transformato uses a common core of two molecules to connect the physical endstates of two molecules via two seperate alchemical paths. The common core is defined as the maximum topology mapping between two molecular graphs using elements to identify matching nodes.
In the example shown below the input are two physical systems (i.e. systems that are parameterized and generated without dummy atoms or unpysical additions to the topology) which are connected via their common core structure.

![SAI_Intro_v2](https://user-images.githubusercontent.com/31651017/138686499-bb678b83-cc80-456a-b33d-0284a7405927.png)

This is done by gradually turning the starting topology and parameter set im the common core molecule. For toluene and methane, the common core structure is a CH3-X, with X as a LJ particle with default vdW parameter. The alchemical transformation is performed by first turning off the electorstatics of the molecules that will become dummy atoms (for toluene this is everything that is in the green circle and for methane it is the red highlighted hydrogen). Afterwards the vdw parameters are turned off, again for the molecules in the green circle (this step is only necessary for toluene, since for methane the X hydrogen is turned into a default LJ particle). This is done via the serial atom approach (for details see  Boresch, S.;  Bruckner, S. Avoiding the van der Waals endpoint problem using serial atomic  insertion. Journal of Computational Chemistry 2011,32, 2449â€“2458).


### How to use transformato for alchemical free energy calculations

## Setting up free energy calculations

Two examples of alchemical free energy calculations are given in the notebooks directory.

In general, the CHARMM-GUI output for the physical endstates is needed.
For the `Loeffler`-benchmark set the necessary  output is shown here:  

An example with the ligands shown above is deposited in transformato/data.
The directory with 2OJ9-e1 has the enol form of the ligand and 2OJ9-e2 the keto form of the ligand.

All these directories are directly taken from CHARMM-GUI. After you solvate either the ligand or the ligand+protein and download the system for openMM you have to run a short minimization using the scripts obtaine from CHARMM-GUI.

To use the Transformato free energy set up the next step is to set up a config file for you run.
The config file for 2OJ9-e1 and 2OJ9-e2 is shown in transformato/config/2oj9_example.yaml.
What is important here is that the tree letter code (tlc) used in the psf is the same as in the config file.



### Maintainers

- Marcus Wieder <marcus.wieder@univie.ac.at> (University of Vienna)
- Johannes Karwounopoulos <johannes.karwounopoulos@univie.ac.at> (University of Vienna)


### Copyright

Copyright (c) 2021, Marcus Wieder, Johannes Karwounopoulos, Stefan Boresch


#### Acknowledgements
 
Project based on the 
[Computational Molecular Science Python Cookiecutter](https://github.com/molssi/cookiecutter-cms) version 1.1.
