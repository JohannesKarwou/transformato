Transformato
==============================
[//]: # (Badges)
[![GitHub Actions Build Status](https://github.com/wiederm/transformato/workflows/CI/badge.svg)](https://github.com/wiederm/transformato/actions?query=workflow%3ACI)
[![codecov](https://codecov.io/gh/wiederm/transformato/branch/master/graph/badge.svg)](https://codecov.io/gh/wiederm/transformato/branch/master)

Transformato is a package that helps to set up relative alchemica free energy calculations of small molecules with a common core scaffold, either for solvation free energy or binding free energy estimates. The package is designed to be used with output generated by CHARMM-GUI (www.charmm-gui.org).

## Theory

Transformato uses a common core of two molecules to connect the physical endstates of two molecules via two seperate alchemical paths. The common core is defined as the maximum topology mapping between two molecular graphs using elements to identify matching nodes.
In the example shown below the input are two physical systems (i.e. systems that are parameterized and generated without dummy atoms or unpysical additions to the topology) which are connected via their common core structure.

![SAI_Intro_v2](https://user-images.githubusercontent.com/31651017/138690737-ebc2cdcd-ee04-459e-b291-ba59b94578f8.png)

This is done by gradually turning the starting topology and parameter set im the common core molecule. For toluene and methane, the common core structure is a CH3-X, with X as a LJ particle with default vdW parameter. The alchemical transformation is performed by first turning off the electorstatics of the molecules that will become dummy atoms (for toluene this is everything that is in the green circle and for methane it is the red highlighted hydrogen). Afterwards the vdw parameters are turned off, again for the molecules in the green circle (this step is only necessary for toluene, since for methane the X hydrogen is turned into a default LJ particle). This is done via the serial atom approach (for details see  Boresch, S.;  Bruckner, S. Avoiding the van der Waals endpoint problem using serial atomic  insertion. Journal of Computational Chemistry 2011,32, 2449â€“2458).


## How to use Transformato for alchemical free energy calculations

A good starting point are the two examples of alchemical free energy calculations given in the notebooks directory.

In general, the CHARMM-GUI output for the physical endstates is needed.
For the `Loeffler`-benchmark set the necessary output is shown here:  https://github.com/wiederm/transformato-systems.
To run the simulations you also need a config file, examples for these are shown in the notebooks directory.

You also need to have openMM or CHARMM/domdec (CHARMM/openMM) installed, depending which of the two MD engines you want to use for energy/force calculations.

## Installation

You can use `python setup.py install` to directly install the code of the repo. Before doing so please take a look in devtools/conda-envs/test_env.yaml to install the dependencies.

### Maintainers

- Marcus Wieder <marcus.wieder@univie.ac.at> (University of Vienna)
- Johannes Karwounopoulos <johannes.karwounopoulos@univie.ac.at> (University of Vienna)


### Copyright

Copyright (c) 2021, Marcus Wieder, Johannes Karwounopoulos, Stefan Boresch


#### Acknowledgements
 
Project based on the 
[Computational Molecular Science Python Cookiecutter](https://github.com/molssi/cookiecutter-cms) version 1.1.
